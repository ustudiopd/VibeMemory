# 프로젝트 만들기(아이디어 생성) 기능 구현 플랜

**작성일**: 2025-11-15  
**목표**: GitHub 리포지토리 없이 직접 아이디어 프로젝트를 생성할 수 있는 기능 추가

---

## 📋 요구사항 분석

### 현재 상태
- ✅ GitHub 리포지토리에서 프로젝트 가져오기 (`/dashboard/import`)
- ✅ 프로젝트는 `repo_owner`, `repo_name`, `repo_url` 필수
- ✅ GitHub Webhook 연동 필수
- ✅ 초기 스캔 및 임베딩 필수

### 추가 요구사항
- 🆕 GitHub 없이 직접 프로젝트 생성
- 🆕 아이디어 프로젝트는 스캔/임베딩 없이 바로 사용 가능
- 🆕 프로젝트 타입 구분 (GitHub 프로젝트 vs 아이디어 프로젝트)
- 🆕 아이디어 프로젝트도 챗봇, 댓글 등 기본 기능 사용 가능

---

## 🎯 설계 방안

### 옵션 A: 프로젝트 타입 필드 추가 (권장)

**장점**:
- 기존 테이블 구조 최소 변경
- 코드 변경 범위 작음
- GitHub 프로젝트와 아이디어 프로젝트 통합 관리

**단점**:
- GitHub 관련 필드가 nullable이 되어야 함
- 조건부 로직이 필요 (GitHub 프로젝트인지 확인)

**구현**:
1. `projects` 테이블에 `project_type` ENUM 추가 (`'github' | 'idea'`)
2. GitHub 관련 필드 (`repo_owner`, `repo_name`, `repo_url`, `webhook_id`) nullable로 변경
3. 아이디어 프로젝트는 GitHub 필드 없이 생성

### 옵션 B: 별도 테이블 분리

**장점**:
- 데이터 모델이 명확함
- GitHub 프로젝트와 아이디어 프로젝트 완전 분리

**단점**:
- 테이블 분리로 인한 복잡도 증가
- 공통 기능(챗봇, 댓글 등) 중복 구현 필요
- 코드 변경 범위 큼

**결론**: **옵션 A 권장** (기존 구조 활용, 최소 변경)

---

## 📐 데이터베이스 스키마 변경

### 1. 프로젝트 타입 ENUM 추가

```sql
-- 프로젝트 타입 ENUM 생성
CREATE TYPE vibememory.project_type AS ENUM ('github', 'idea');

-- projects 테이블에 project_type 컬럼 추가
ALTER TABLE vibememory.projects 
ADD COLUMN IF NOT EXISTS project_type vibememory.project_type NOT NULL DEFAULT 'github';

-- GitHub 관련 필드를 nullable로 변경
ALTER TABLE vibememory.projects 
ALTER COLUMN repo_owner DROP NOT NULL,
ALTER COLUMN repo_name DROP NOT NULL,
ALTER COLUMN repo_url DROP NOT NULL;

-- 아이디어 프로젝트는 GitHub 필드가 없어도 되도록 제약 조건 조정
-- (기존 UNIQUE 제약 조건이 있으면 제거 필요)
ALTER TABLE vibememory.projects 
DROP CONSTRAINT IF EXISTS projects_repo_url_key;

-- project_type이 'github'일 때만 repo_url이 필수
ALTER TABLE vibememory.projects 
ADD CONSTRAINT projects_github_requires_repo_url 
CHECK (
  (project_type = 'github' AND repo_url IS NOT NULL) OR 
  (project_type = 'idea')
);
```

### 2. 인덱스 추가

```sql
-- project_type 인덱스 추가
CREATE INDEX IF NOT EXISTS idx_projects_project_type 
ON vibememory.projects(project_type);

-- owner_id와 project_type 복합 인덱스
CREATE INDEX IF NOT EXISTS idx_projects_owner_type 
ON vibememory.projects(owner_id, project_type);
```

---

## 🔧 백엔드 구현

### 1. 프로젝트 생성 API (`POST /api/projects/create`)

**요청 본문**:
```typescript
{
  project_type: 'idea',
  project_name: string,
  description?: string,
  tech_spec?: string,
  deployment_url?: string,
  documentation_url?: string,
}
```

**응답**:
```typescript
{
  success: true,
  project_id: string,
  message: '프로젝트가 생성되었습니다.',
}
```

**구현 내용**:
- `project_type`이 `'idea'`인 경우 GitHub 관련 필드 없이 프로젝트 생성
- `ingestion_runs` 생성하지 않음 (스캔 불필요)
- `scan_progress` 생성하지 않음
- 프로젝트 상세 페이지로 리다이렉트

### 2. 프로젝트 목록 API 수정 (`GET /api/projects`)

- `project_type` 필드 포함
- GitHub 프로젝트와 아이디어 프로젝트 모두 반환
- 정렬: 최신순 (기존과 동일)

### 3. 프로젝트 상세 API 수정 (`GET /api/projects/[id]`)

- `project_type` 확인
- 아이디어 프로젝트인 경우:
  - 진행 상황 탭 비활성화 또는 "스캔 불필요" 메시지
  - 파일 목록 탭 비활성화
  - 재스캔 버튼 숨김
  - GitHub 정보 불러오기 버튼 숨김

---

## 🎨 프론트엔드 구현

### 1. 대시보드 페이지 수정 (`/dashboard`)

**변경 사항**:
- "프로젝트 만들기" 버튼 추가 (GitHub 가져오기 옆)
- 프로젝트 카드에 타입 표시 (선택적)
  - GitHub 프로젝트: "GitHub" 배지
  - 아이디어 프로젝트: "아이디어" 배지

### 2. 프로젝트 만들기 페이지 (`/dashboard/create`)

**UI 구성**:
```
┌─────────────────────────────────────┐
│ 프로젝트 만들기                      │
├─────────────────────────────────────┤
│                                     │
│ 프로젝트 이름 *                      │
│ [___________________________]       │
│                                     │
│ 프로젝트 설명                        │
│ [___________________________]       │
│ [___________________________]       │
│                                     │
│ 기술 스펙                            │
│ [___________________________]       │
│ [___________________________]       │
│                                     │
│ 실행 URL (선택)                      │
│ [___________________________]       │
│                                     │
│ 문서 URL (선택)                      │
│ [___________________________]       │
│                                     │
│ [ 취소 ]  [ 프로젝트 만들기 ]        │
└─────────────────────────────────────┘
```

**기능**:
- 프로젝트 이름 필수 입력
- 설명, 기술 스펙, URL 선택 입력
- 생성 버튼 클릭 시 API 호출
- 성공 시 프로젝트 상세 페이지로 이동

### 3. 프로젝트 상세 페이지 수정 (`/dashboard/projects/[id]`)

**조건부 렌더링**:
- `project_type === 'idea'`인 경우:
  - 진행 상황 탭: "아이디어 프로젝트는 스캔이 필요하지 않습니다." 메시지
  - 파일 목록 탭: "아이디어 프로젝트에는 파일 목록이 없습니다." 메시지
  - 재스캔 버튼: 숨김
  - GitHub 정보 불러오기 버튼: 숨김
- `project_type === 'github'`인 경우:
  - 기존 동작 유지

### 4. 모바일 탭바 수정

**변경 사항**:
- "가져오기" 탭을 "추가" 탭으로 변경
- "추가" 탭 클릭 시:
  - 하단 시트 표시
  - "GitHub에서 가져오기" 옵션
  - "새 프로젝트 만들기" 옵션

---

## 📝 구현 단계

### Phase 1: 데이터베이스 스키마 변경
1. ✅ Migration 파일 생성
2. ✅ `project_type` ENUM 추가
3. ✅ `projects` 테이블 컬럼 추가/수정
4. ✅ 제약 조건 추가
5. ✅ 인덱스 추가

### Phase 2: 백엔드 API 구현
1. ✅ 프로젝트 생성 API (`POST /api/projects/create`)
2. ✅ 프로젝트 목록 API 수정 (`GET /api/projects`)
3. ✅ 프로젝트 상세 API 수정 (`GET /api/projects/[id]`)
4. ✅ 프로젝트 타입 검증 로직 추가

### Phase 3: 프론트엔드 UI 구현
1. ✅ 프로젝트 만들기 페이지 (`/dashboard/create`)
2. ✅ 대시보드 페이지 수정 (만들기 버튼 추가)
3. ✅ 프로젝트 상세 페이지 수정 (조건부 렌더링)
4. ✅ 모바일 탭바 수정 (선택적)

### Phase 4: 테스트 및 검증
1. ✅ 아이디어 프로젝트 생성 테스트
2. ✅ 프로젝트 목록 표시 테스트
3. ✅ 프로젝트 상세 페이지 테스트
4. ✅ 챗봇 기능 테스트 (아이디어 프로젝트)
5. ✅ 댓글 기능 테스트

---

## 🔍 고려사항

### 1. 챗봇 기능
- **현재**: RAG 기반 검색 (임베딩된 청크 검색)
- **아이디어 프로젝트**: 임베딩이 없으므로 RAG 검색 불가
- **해결 방안**:
  - 옵션 A: 챗봇 비활성화 (권장)
  - 옵션 B: 프로젝트 설명/기술 스펙을 컨텍스트로 사용 (간단한 프롬프트)
  - 옵션 C: 아이디어 프로젝트도 수동으로 문서 추가 가능하도록 확장 (향후)

### 2. AI 분석 기능
- **현재**: GitHub 파일 기반 분석
- **아이디어 프로젝트**: 파일이 없으므로 분석 불가
- **해결 방안**:
  - AI 분석 탭 비활성화 또는 "아이디어 프로젝트는 AI 분석을 지원하지 않습니다." 메시지

### 3. 파일 관리
- **현재**: GitHub 파일 자동 동기화
- **아이디어 프로젝트**: 파일 없음
- **해결 방안**:
  - 파일 목록 탭 비활성화 또는 빈 상태 메시지

### 4. 진행 상황 추적
- **현재**: 스캔 진행률 표시
- **아이디어 프로젝트**: 스캔 불필요
- **해결 방안**:
  - 진행 상황 탭에 "아이디어 프로젝트는 스캔이 필요하지 않습니다." 메시지

---

## 🎯 우선순위

### 높음 (필수)
1. 데이터베이스 스키마 변경
2. 프로젝트 생성 API
3. 프로젝트 만들기 페이지
4. 프로젝트 상세 페이지 조건부 렌더링

### 중간 (권장)
5. 대시보드에 만들기 버튼 추가
6. 프로젝트 타입 배지 표시
7. 모바일 탭바 수정

### 낮음 (선택)
8. 아이디어 프로젝트 챗봇 기능 (간단한 프롬프트 기반)
9. 아이디어 프로젝트 문서 추가 기능 (향후 확장)

---

## 📊 예상 작업 시간

- **Phase 1 (DB)**: 1시간
- **Phase 2 (Backend)**: 2-3시간
- **Phase 3 (Frontend)**: 3-4시간
- **Phase 4 (Test)**: 1-2시간

**총 예상 시간**: 7-10시간

---

## 🚀 다음 단계

1. 사용자 승인 후 구현 시작
2. Phase 1부터 순차적으로 구현
3. 각 Phase 완료 후 테스트
4. 모든 Phase 완료 후 통합 테스트

