네, 알겠습니다. **모든 백엔드 AI 호출을 `gpt-5-mini`로 통일**하는 것으로 구상안을 수정하겠습니다.

'명세서 생성' 같이 더 강력한 모델이 필요할 수 있는 작업은 `gpt-5-mini`가 1차 처리를 하되, 브라우저 LLM(클라이언트 사이드)에서 고도화할 수 있는 기반을 마련하는 것으로 이해했습니다.

수정된 통합 플랜을 다시 제안합니다.

-----

# (수정본) 프로젝트 만들기 및 아이디어 인큐베이팅 기능 구현 플랜

**목표**: GitHub 리포지토리 없이 '아이디어' 타입의 프로젝트를 생성하고, 해당 프로젝트 내에서 파일 업로드 및 AI 챗봇을 통해 아이디어를 '명세서'로 발전시킨 후, Cursor 등 개발 도구로 연계하는 '아이디어 인큐베이팅' 기능을 구현합니다. (모든 백엔드 AI 모델은 `gpt-5-mini`로 통일)

-----

## 1단계: 기술 기반 구축 (엔티티 생성)

기존 `프로젝트_만들기_기능_플랜.md`의 내용을 기반으로 '아이디어' 타입을 저장할 수 있는 기술적 토대를 구축합니다.

### 1.1. 데이터베이스 스키마 변경

  * **설계**: 옵션 A (권장)
      * `projects` 테이블에 `project_type` ENUM (`'github' | 'idea'`) 컬럼을 추가합니다.
      * `repo_owner`, `repo_name`, `repo_url` 등 GitHub 관련 필드를 `nullable`로 변경합니다.
      * `project_type = 'github'`일 때만 `repo_url`이 필수이도록 `CHECK` 제약 조건을 추가합니다.
  * **파일 관리용 테이블**: '아이디어 캔버스'에 업로드될 파일을 위해 별도 테이블이 필요합니다.
    ```sql
    -- 아이디어 프로젝트용 파일 메타데이터
    CREATE TABLE vibememory.idea_project_files (
      id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
      project_id uuid REFERENCES vibememory.projects(id) ON DELETE CASCADE NOT NULL,
      file_name TEXT NOT NULL,
      file_type TEXT,
      storage_path TEXT NOT NULL,
      created_at TIMESTAMPTZ DEFAULT now()
    );

    -- 아이디어 파일의 RAG용 청크 (기존 repo_file_chunks와 유사)
    CREATE TABLE vibememory.idea_project_chunks (
      id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
      project_id uuid REFERENCES vibememory.projects(id) ON DELETE CASCADE NOT NULL,
      file_id uuid REFERENCES vibememory.idea_project_files(id) ON DELETE CASCADE NOT NULL,
      content TEXT,
      embedding VECTOR(1536), -- text-embedding-3-small
      token_count INT
    );
    ```

### 1.2. 백엔드 API 구현

  * **`POST /api/projects/create`**
      * `project_type: 'idea'`, `project_name` 등을 받아 GitHub 정보 없이 프로젝트를 생성합니다.
      * `ingestion_runs` 또는 `scan_progress`를 생성하지 않습니다.
  * **`GET /api/projects`**
      * `project_type`을 포함하여 모든 프로젝트 목록을 반환합니다.
  * **`GET /api/projects/[id]`**
      * `project_type`에 따라 반환되는 데이터를 구분합니다.

### 1.3. 프론트엔드 UI (기반)

  * **`/dashboard/create` 페이지**
      * 프로젝트 이름, 설명 등을 입력받는 새 프로젝트 생성 폼을 구현합니다.
  * **`/dashboard` 페이지**
      * '프로젝트 만들기' 버튼을 추가합니다.

-----

## 2단계: 아이디어 인큐베이팅 기능 구현

1단계에서 생성한 '아이디어' 프로젝트의 상세 페이지(`dashboard/projects/[id]`)에 기존 탭(GitHub 파일, 진행 상황) 대신 새로운 전용 탭을 구현합니다.

### 2.1. 프론트엔드: "아이디어 노트" 탭

  * **조건부 렌더링**: `project_type === 'idea'`일 경우,
      * **(숨김)** '진행 상황', '파일 목록', '릴리즈 노트' 등 GitHub 기반 탭
      * **(활성화)** \*\*"아이디어 노트"\*\*라는 새로운 기본 탭

### 2.2. "아이디어 노트" 탭 상세 기능

"아이디어 노트" 탭은 '아이디어 캔버스'와 '디벨롭 챗봇' 두 영역으로 구성됩니다.

#### 1\. 아이디어 캔버스 (파일 업로드)

  * **기능**: 아이디어 관련 `.md`, `.txt` 파일을 업로드하는 영역입니다.
  * **백엔드**:
      * 파일 업로드 API (`POST /api/projects/[id]/idea/upload`)
      * 파일 수신 시 `idea_project_files`에 메타데이터 저장
      * **비동기 임베딩**: 파일 내용을 청킹하여 `idea_project_chunks`에 저장 및 임베딩 (P2 임베딩 로직 재사용)
  * **프론트엔드**: 업로드된 파일 목록 표시 (`idea_project_files` 조회)

#### 2\. 디벨롭 챗봇 (AI 어시스턴트)

  * **기능**: 아이디어를 명세서로 발전시키기 위한 AI 챗봇
  * **시스템 프롬프트**: "당신은 사용자의 아이디어를 구체적인 명세서로 만들어주는 프로덕트 매니저입니다. 역으로 질문하고 기능을 구체화하도록 유도하세요."
  * **RAG 컨텍스트**:
    1.  사용자가 '아이디어 캔버스'에 업로드한 파일 (`idea_project_chunks` 검색)
    2.  현재 챗봇과의 대화 기록
  * **AI 모델**: **`gpt-5-mini`**
      * *이유*: RAG 컨텍스트(입력) 비용이 저렴하고, 실시간 대화에 적합한 속도와 성능을 제공하는 표준 모델로 사용합니다.

#### 3\. 명세서 생성 (AI 합성)

  * **기능**: '아이디어 노트' 탭의 "명세서 생성하기" 버튼
  * **백엔드**:
      * 명세서 생성 API (`POST /api/projects/[id]/idea/synthesize`)
      * **컨텍스트 수집**: (1) `idea_project_files`의 모든 텍스트 내용 + (2) '디벨롭 챗봇'의 전체 대화 기록
      * **AI 합성**: 수집된 컨텍스트를 LLM에 전달하여 `specification.md` 초안 생성
  * **AI 모델**: **`gpt-5-mini`**
      * *이유*: 표준 AI 모델로 `gpt-5-mini`를 사용하여 1차 명세서 초안을 생성합니다. (더 강력한 합성이 필요한 경우 브라우저 LLM을 활용하는 사용자 구상안 반영)

#### 4\. Cursor로 내보내기 (Handoff)

  * **기능**: 생성된 `specification.md`를 기반으로 Cursor용 프롬프트를 생성하는 버튼
  * **동작**:
    1.  버튼 클릭 시 모달 창 열림
    2.  모달에 `specification.md` 내용이 포함된 'Cursor 최적화 프롬프트' 표시
    3.  사용자가 이 프롬프트를 복사하여 Cursor의 새 프로젝트 생성에 사용

-----

## 3단계: 구현 마일스톤

1.  **Phase 1: 기술 기반 구축**

      * [1.1] 데이터베이스 스키마 변경 (ENUM 추가, `nullable` 변경, 새 테이블 생성)
      * [1.2] 기본 백엔드 API 구현 (`/create`, `/projects`, `/[id]` 수정)
      * [1.3] 프론트엔드 폼/페이지 생성 (`/dashboard/create`)

2.  **Phase 2: "아이디어 노트" 탭 구현**

      * [2.1] `/[id]` 페이지에서 `project_type`에 따른 조건부 탭 라우팅
      * [2.2.1] "아이디어 캔버스" 파일 업로드 API 및 비동기 임베딩 로직
      * [2.2.2] "디벨롭 챗봇" UI 및 RAG 연동 (with `gpt-5-mini`)

3.  **Phase 3: 합성 및 핸드오프**

      * [2.2.3] "명세서 생성" API 구현 (with `gpt-5-mini`)
      * [2.2.4] "Cursor로 내보내기" 프롬프트 생성 기능 구현