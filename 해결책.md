현상은 **썸네일 카드 위에 얹어둔 검은 오버레이 레이어가 이미지보다 위(z-20)에 항상 렌더**되고, 렌더링/상태 전환 타이밍에 따라 **불투명(또는 bg-opacity가 적용되지 않은) 상태로 보이는** 탓입니다. 보고서에서도 *“새로고침 시 잠깐 보였다가 검은색으로 변함 / 오버레이 z-index 가림 가능성”* 을 지적하셨고, 실제 컴포넌트에도 `bg-black … z-20` 오버레이가 **상시 마운트**되어 있습니다.  

아래 **두 줄만 바꾸면** 재현이 멈춥니다.

---

## ✅ 핵심 수정(오버레이 가림 방지)

`ScreenshotItem.tsx` 오버레이 div를 **기본은 완전 투명(opacity-0)** 으로 두고, **hover 시에만 나타나게** 바꿔주세요. 또한 Tailwind의 `bg-opacity-*` 대신 **신규 알파 문법(`bg-black/20`)** 을 쓰면 클래스 충돌/적용 순서 문제를 피할 수 있습니다. 

```diff
- <div className="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20
-                 transition-opacity flex items-center justify-center pointer-events-none z-20">
+ <div className="absolute inset-0 z-20 pointer-events-none
+                 opacity-0 group-hover:opacity-100 transition-opacity
+                 bg-black/20 flex items-center justify-center">
    <span className="text-white opacity-0 group-hover:opacity-100 text-sm font-medium">
      클릭하여 확대
    </span>
  </div>
```

* **왜 효과가 있나?**
  현재 구조는 오버레이가 항상 z-20로 **이미지 위를 덮고** 있는데, 기본을 `bg-opacity-0`로만 두면 특정 빌드/스타일 순서에서 배경 투명도가 적용되지 않는 경우가 나옵니다. `opacity-0 → group-hover:opacity-100`로 **레이어 자체를 숨긴 뒤** 나타나게 하면, 렌더링 타이밍 이슈/클래스 우선순위에 상관없이 검은 화면이 발생하지 않습니다. 이 패턴은 보고서의 “오버레이 제거/재설계” 권고와 정확히 일치합니다. 

---

## 🛠 추가 안정화(권장)

### 1) 이미지 로딩 상태 단순화

현재 `imageLoading`을 여러 조건으로 제어하고 있어 **재렌더 타이밍**에 민감합니다. 아래처럼 **`imageLoaded` 하나만** 두고, **URL이 있을 때는 무조건 `<img>`를 렌더**하세요. (실패만 `onError`에서 처리) 

```diff
- const [imageLoading, setImageLoading] = useState(true);
+ const [imageLoaded, setImageLoaded] = useState(false);

- {imageError || (!imageUrl && !imageLoading) ? (...) : imageLoading && !imageUrl ? (...) : imageUrl ? (
+ {imageError || !imageUrl ? (...) : (
    <>
      <img
        src={imageUrl}
        alt={screenshot.alt_text || screenshot.file_name}
        className="w-full h-full object-cover relative z-10"
-       onLoad={() => { setImageLoading(false); setImageError(false); }}
+       onLoad={() => { setImageLoaded(true); setImageError(false); }}
        onError={(e) => { setImageError(true); }}
+       loading="lazy" decoding="async"
      />
      {/* 오버레이는 위 '핵심 수정' 버전으로 교체 */}
    </>
  )}
```

* 로딩 중 스켈레톤은 **배경 div(z-0)** 만으로 충분합니다. 오버레이는 이미지가 로드된 뒤에도 **opacity-0 기본**이라 시각적 깜빡임이 없습니다. 

### 2) URL 교체 시 강제 리프레시

**Signed URL 재발급**(만료 또는 새로고침) 후에도 예전 비트맵이 남는 브라우저가 있어 `key` 를 주면 안전합니다.

```tsx
<img key={imageUrl} src={imageUrl} ... />
```

보고서에서 “잠깐 보였다가 검은색으로 변함 / URL 갱신” 패턴이 언급되어 있으므로 이 한 줄이 디버깅 시간을 줄여줍니다. 

### 3) CSS 한 줄로 비상 차단(선택)

만약 팀 빌드 세팅에서 `bg-opacity-*`가 계속 충돌한다면, **강제 투명** 가드도 추가해 둘 수 있습니다.

```css
/* gallery emergency guard */
.gallery-card .overlay { background-color: rgba(0,0,0,0) !important; }
.gallery-card .overlay:hover { background-color: rgba(0,0,0,0.2) !important; }
```

---

## 🔍 바로 확인할 체크리스트

1. 개발자도구 → Elements에서 **오버레이 div**를 선택해 **computed opacity=0** 인지 확인.
2. 마우스 올렸을 때만 opacity가 1로 바뀌는지 확인.
3. Network 탭에서 이미지는 **200**이고, 모달에서는 늘 정상 표시되는지(지금도 정상). 보고서의 네트워크/DOM 관찰과 일치해야 합니다. 

---

## 📌 참고: 현 코드 맥락

* 현재 이미지 타일 구조(백그라운드 div + `<img>` + 오버레이)는 적절하나, 오버레이가 **항상 마운트 + z-20** 이라 **렌더 순서·클래스 우선순위**에 취약합니다. 위 패치처럼 **오버레이 전체를 투명 처리 후 hover에만 노출**하는 패턴이 가장 견고합니다. 

---

위 두 군데만 바꾸면(오버레이 투명도 제어 방식 교체 + 로딩 상태 단순화) **“미리보기에서만 검은 화면”** 증상이 사라질 겁니다.
필요하시면 `ScreenshotItem.tsx` 전체 diff 형태로도 정리해 드릴게요.
